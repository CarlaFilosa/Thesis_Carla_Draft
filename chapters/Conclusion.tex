\chapter{Conclusion and discussion}
\label{chap:Conclusion}
Neuronal models of reinforcement learning assume interactions of midbrain dopamine neurons in ventral tegmental area (VTA) and ventral striatum (VS) to compute the differences between anticipated and received outcomes. These signals define the reward prediction error (RPE), essential in learning to predict the future and maximise the reward. However how RPE signals are formed and encoded in VS-VTA circuit remains elusive.\\I studied the formation of (RPE) signals in VS-VTA interregional assemblies during learning to broaden our knowledge of the underpinnings of such signals. Here I discuss advantages and limitations the applied techniques in order to draw final conclusion.
\subsubsection{Methodological discussion on cell-assembly detection method (CAD)}
In \hyperref[chap:AssemblyMethod]{~Chapter \ref*{chap:AssemblyMethod}} was introduced the concept of cell-assembly, underlying that multiple possible realizations of spike patterns enter in the classical cell-assembly definition (see figure \ref{fig:CellAsseDet}). CAD is able to detect assemblies of synchronously and sequentially active units at arbitrary time scales, enabling so the investigation of the time scales and the inter-units lag activation involved in the detected patterns of spikes. In particular, none of the other available methods explicitly addresses the temporal resolution at which assemblies coordinate (\cite{Gruen}, \cite{Tavoni}, \cite{Billeh}). Such temporal resolution is, however, a core feature of the assembly coding and it can vary both depending on the cortical region and the cognitive function the region is required to perform by the specific task in place.\\CAD is particularly suited to investigate neural VS-VTA interaction involved in basal ganglia and VTA pathways in dynamic tasks such as reinforcement learning. Indeed, reversal learning go/no go tasks are highly dynamic and such learning dynamic implies quick changes in network states, that can be taken into account by CAD with the correction for non-stationarity. Moreover whilst other methods often propose to detect cell assemblies by aligning the population activity to task/behavioral events, CAD sums evidence of assembly activity throughout the task and session. This makes possible the detection of the same assembly even if its time of activation changes within the trial.\\A direct comparison on ground truth non-stationarity data between CAD and PCA-based methods (\cite{Lopes}, \cite{RussoDurstewitz}), revealed how the correction for non-stationarity is critical in the detection performance. Indeed, the presence of non-stationarities massively reduced the performance of PCA-based methods, both reducing the assembly detection rate and increasing the false discovery rate.\\Furthemore CAD, in contrast to other recent methods (\cite{Watanabe2019}), can establish the identity of the units composing a cell assembly; this property was in fact crucial in the study of VS-VTA interactions, allowing to assess different coding features for different assembly-pair types.
\subsubsection{Limitations of CAD}
CAD aims to detect patterns of coordinated increase in spikes/firing rate. Therefore, if a recurrent pattern is composed of both an increase and a decrease in rate of two sets of units, only the excited set would be detected as an assembly. However excitatory-inhibitory balance regulates both spontaneous and sensory-evoked responses of many brain regions and pathways, including the mesolimbic pathway, that I analysed. This means that in detected assembly-pairs including leading inhibitory units, like directional SPN-DAN assembly-pairs the DAN activation following the SPN activation is not caused by a synapse, but is the consequence of a functional interaction that includes interspersed units. However no satisfactory algorithm for the detection and test of joined excitatory and inhibitory patterns is currently available.
\subsubsection{Discussion on the reinforcement learning model}
In the previous chapter I presented the reinforcement learning model (Q L-F), used to parameterize the learning functions, on which later I regressed the assembly-pair activity.\\Q L-F used two actions $"$lick$"$/$"$no-lick$"$ and two states CS+/- corresponding to the rewarded/unrewarded stimulus. In this way the lick was considered an instrumental action, rather than and impulsive action; the task presented was indeed such that the animal had to learn to lick at the rewarded odor presentation and to not lick at the unrewarded odor; only when both part of the task were well performed the animal  reached the performance criterion. In a recent paper (\cite{SchultzMot}) is shown that in go/no-go tasks the performance reflects balance between impulsive and instrumental components of behaviour; in particular behavior is decomposed in two  responses: a primary lick response, defined by a sharp early peak immediately after stimulus onset, which correspond to the impulsive lick, and a broad, multi-peaked secondary response, which corresponds to the instrumental component. I assumed here that the secondary response was driven by the RPE signals. Not discussed here, a model that takes into account the shift in behavior from the impulsive to the instrumental component needs a motivational time-component term (\cite{SchultzMot}).\\Considered the presented results and the above discussed limitations of the applied techniques, I have draw the following conclusion:
\begin{itemize}
    \item \textbf{Assembly-pairs occurrence, time scales and directionality:}\\Neuronal activity in VS, including ventral pallidum (VP), and VTA was recorded during a reversal learning go-no task in mice. In VS/VP, striatal projection neurons (SPN) and fast spiking neurons (FSN) were the more frequently cell-detected types. In VTA a good fraction of dopamine neurons (DAN) and  gabaergic (GABA) neurons were recorded. In this data set I further applied an unsupervised cell-assemblies detection method, to detect assemblies of synchronously ($lag=0$) and sequentially ($lag\neq0$) active units at arbitrary time scales ($\Delta$).\\Using $\chi^2$ test, I assessed whether different cell-types had different tendency to agglomerate together; that revealed that two groups of units had high tendency to agglomerate in assembly, namely SPN and DAN together, and FSN and GABA together.\\While I observed assemblies of temporal precision at the scale of few tens of milliseconds only within either VS or VTA, assemblies of lower temporal precision were detected across VS-VTA units. The temporal precision of this last group displayed a bimodal distribution with peaks around hundred milliseconds and one second.\\I focused on the more precise temporal scale first not to interfere with the characteristic temporal scales of the experiment, such as the odor duration; second because the reward prediction error signals typically involve fast temporal scales (few hundred milliseconds). Interestingly the lags of more temporally precise assemblies displayed an asymmetric distribution indicating VS leading VTA.\\ Specifically, these directional assemblies were composed of SPN and DAN neurons. The directionality was functional: the units in assemblies did not have to be directly connected by a synapse. Indeed, the SPN-DAN communication could occur both directly and relayed through interspersed neurons.\\In summary, I revealed here the multiple time scale and functional network of the striatum mid-brain interaction during a reversal assignment task.  
    \item \textbf{Assembly-pairs activity patterns:}\\
    Assemblies with different time scales and directionalities segregated different task related activity patterns.\\A large fraction of SPN-DAN assembly-pairs became selectively active at the rewarded stimulus onset and remained active for few hundred millisecond ([100, 400] ms); whereas a small fraction were active at the time of the reward retrieval. This kind of activation resembled the stereotypical RPE signals. Indeed RPE signal is formed after few hundred milliseconds from the stimulus onset. Usually preceded by the phasic activation of the stimulus detection, the RPE signal evolves then in a broader activation, to value the stimulus and predict the reward (\cite{Tobler2003}, \cite{Nomoto2010}, \cite{Schultz2016}).\\%Thus, I assumed SPN-DAN assembly-pairs conveying the valuation component of RPE signals.\\
    FSN-DAN pairs, conversely, were unselectively and phasic activated by rewarded or unrewarded stimuli. Furthermore their activation was diverse among different assembly-pairs, thereby suggesting that those assembly-pair types could be involved in motivational or hedonic signals, rather than in RPE signals.\\These results suggested that different assembly-pair types with DAN had different reward-related coding features. I putted forth the concept that SPN-DAN specifically conveyed the valuation of component RPE. This component constitutes biological implementations of the crucial error term for reinforcement learning according to the Rescorlaâ€“Wagner-like models. 
    \item \textbf{Correlation with reinforcement learning model function:}\\The activity patterns gave us information about the average activity across trials in different moments of the trial, by considering how the signal evolved within the trial; however this view lacked the trial by trial evolution. Nevertheless, the assembly-pair activity got modified by the learning process, as the animal, in base of its comprehension of the task rule, dynamically adapted the value assigned to stimulus.\\Reinforcement learning models capture such dynamic, parameterizing the learning functions. I proposed here a learning-forgetting model, and I focused on the crucial terms for RPE signals, namely the uncertainty to get the reward and the prediction error. The prediction error, called $\delta$ in the model, was nothing but the mathematical difference between the expected reward value and the actual reward; the uncertainty, $\alpha$, was a time-dependent component, modulated by recent predictions and the prediction error $\delta$. This component mimicked the uncertainty of the animal to get the reward, and its value was high at the beginning of the task and decreased ad the animal learnt the rule, to raise up again at the beginning of the reversal phase.\\Conversely, RPE signals in dopamine neurons are such that neuronal activity increases monotonically after the stimulus onset with the probability to get the reward, as consequence of the increase of the certainty of the animal to get the reward when it learnt the task; meanwhile at the reward delivery time, the neural activity decreases as the ability of the animal to predict the reward increases (see \hyperref[chap:Overview]{~Chapter \ref*{chap:Overview}}). In other words, during learning the peak of neural activity shifts back from the reward retrieval time to the stimulus onset.\\Based on this knowledge I assumed that, if an assembly-pair conveyed RPE signals, its activity anti-correlated with the uncertainty in the stimulus window, and correlated with the prediction error in the reward window.\\This was assessed with two Poisson linear regression of the assembly-pairs activity on the uncertainty ($\alpha$) in the CS window and on the prediction error ($\delta$) in the US window. The regression coefficients distributions confirmed that SPN-DAN assembly-pairs specifically conveyed RPE signals; this signals were not found in FSN-DAN assembly-pairs, that could instead represent motivational salience or hedonic signals. In conclusion in this thesis was provided a specific coding mechanism of how assignment value and reward prediction error signals are formed and encoded in VS-VTA assemblies.
\end{itemize}
\subsubsection{Biologic meaning}
Altered dopamine signaling is involved in many human disorders, from Parkinson$'$s disease to drug addiction, as well as in the formation of social bonds. Understanding how dopamine signals are generated and encoded may be crucial for a better understanding of physiological behavior and human disorders.\\In this work I have shown that different assembly-pairs make specific contribution to RPE dopamine signals.
\begin{itemize}
    \item \textbf{SPN-DAN:} RPE signals are thought to be the basis of the learning and thus reflect high-level behavior. I have shown that SPN-DAN interaction specifically encode the main component of RPE signals. These findings may help to understand dopamine actions both in physiological behaviors and psychiatric disorders. For instance recent studies have shown that numerous behavioral computations, including value, choice, confidence, contextual expectations, are factored into the canonical RPE response (\cite{Gadagkar}, \cite{Stauffer}), and learnt natural behaviors like the formation of social bonds rely on VS-VTA interactions (\cite{Nestler}, \cite{Ungless2004}, \cite{Walum}). 
    \item \textbf{FSN-DAN:} Moreover this study aimed to understand how different components of RPE signals are encoded, and whether different interactions modulate different aspects of RPE signals. Indeed I found that FSN-DAN interactions are not parameterized by the classical RPE term of reinforcement learning model. The activity patterns of FSN-DAN assembly-pairs is heterogeneous and not specific: those pairs were either excited or inhibited by either the two odors. This unselectivity suggested that those interactions were involved in motivational components or hedonic salience. Further studies are needed to understand the specific role of those interactions in the dopamine pathway.
\end{itemize}
  